{
  "hash": "98255afad0eb250f13f66609b4c57edd",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Surveys: Design and Analysis\"\ndescription: \"\"\nauthor:\n  - name: Basil Okola\n    url: https://bokola.github.io/\n    # orcid: 0000-0002-5300-3075\n    affiliation: Master of Statistics and Data Science @ Hasselt University\n    affiliation-url: https://ucsb-meds.github.io/ \ndate: 2026-01-15\ncategories: [biostatistics,survey design] # self-defined categories\n# include-after-body: pub_ready_viz.html\ncitation: \n  url: https://bokola.github.io/posts/2026-01-15-survey-design/ \n\ndraft: false # setting this to `true` will prevent your post from appearing on your listing page until you're ready!\n# bibliography: reference.bib\n---\n\n\n# Analysis\n\n\n\n## Data\n\nProvided by `{srvyrexploR}` library. The first is America's elections data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata('anes_2020', package = \"srvyrexploR\")\nanes_2020 %>% select(-matches(\"^V\\\\d\")) %>%# starts with V followed by a digit\nglimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 7,453\nColumns: 21\n$ CaseID                  <dbl> 200015, 200022, 200039, 200046, 200053, 200060…\n$ InterviewMode           <fct> Web, Web, Web, Web, Web, Web, Web, Web, Web, W…\n$ Weight                  <dbl> 1.0057375, 1.1634731, 0.7686811, 0.5210195, 0.…\n$ VarUnit                 <fct> 2, 2, 1, 2, 1, 2, 1, 2, 2, 2, 1, 1, 2, 2, 2, 2…\n$ Stratum                 <fct> 9, 26, 41, 29, 23, 37, 7, 37, 32, 41, 22, 7, 3…\n$ CampaignInterest        <fct> Somewhat interested, Not much interested, Some…\n$ EarlyVote2020           <fct> NA, NA, NA, NA, NA, NA, NA, NA, Yes, NA, NA, N…\n$ VotedPres2016           <fct> Yes, Yes, Yes, Yes, Yes, No, Yes, No, Yes, Yes…\n$ VotedPres2016_selection <fct> Trump, Other, Clinton, Clinton, Trump, NA, Oth…\n$ PartyID                 <fct> Strong republican, Independent, Independent-de…\n$ TrustGovernment         <fct> Never, Never, Some of the time, About half the…\n$ TrustPeople             <fct> About half the time, Some of the time, Some of…\n$ Age                     <dbl> 46, 37, 40, 41, 72, 71, 37, 45, 70, 43, 37, 55…\n$ AgeGroup                <fct> 40-49, 30-39, 40-49, 40-49, 70 or older, 70 or…\n$ Education               <fct> Bachelor's, Post HS, High school, Post HS, Gra…\n$ RaceEth                 <fct> \"Hispanic\", \"Asian, NH/PI\", \"White\", \"Asian, N…\n$ Gender                  <fct> Male, Female, Female, Male, Male, Female, Fema…\n$ Income                  <fct> \"$175,000-249,999\", \"$70,000-74,999\", \"$100,00…\n$ Income7                 <fct> $125k or more, $60k to < 80k, $100k to < 125k,…\n$ VotedPres2020           <fct> NA, Yes, Yes, Yes, Yes, Yes, Yes, NA, Yes, Yes…\n$ VotedPres2020_selection <fct> NA, Other, Biden, Biden, Trump, Biden, Trump, …\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanes_2020 %>% select(-matches(\"^V\\\\d\")) %>% skimr::skim()\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |           |\n|:------------------------|:----------|\n|Name                     |Piped data |\n|Number of rows           |7453       |\n|Number of columns        |21         |\n|_______________________  |           |\n|Column type frequency:   |           |\n|factor                   |18         |\n|numeric                  |3          |\n|________________________ |           |\n|Group variables          |None       |\n\n\n**Variable type: factor**\n\n|skim_variable           | n_missing| complete_rate|ordered | n_unique|top_counts                                 |\n|:-----------------------|---------:|-------------:|:-------|--------:|:------------------------------------------|\n|InterviewMode           |         0|          1.00|FALSE   |        3|Web: 7064, Vid: 274, Tel: 115              |\n|VarUnit                 |         0|          1.00|FALSE   |        3|2: 3750, 1: 3689, 3: 14                    |\n|Stratum                 |         0|          1.00|FALSE   |       50|12: 179, 6: 172, 27: 172, 21: 170          |\n|CampaignInterest        |         1|          1.00|FALSE   |        3|Ver: 3940, Som: 2569, Not: 943             |\n|EarlyVote2020           |      6963|          0.07|FALSE   |        2|Yes: 375, No: 115                          |\n|VotedPres2016           |        21|          1.00|FALSE   |        2|Yes: 5810, No: 1622                        |\n|VotedPres2016_selection |      1686|          0.77|FALSE   |        3|Cli: 2911, Tru: 2466, Oth: 390             |\n|PartyID                 |        25|          1.00|FALSE   |        7|Str: 1796, Str: 1545, Ind: 881, Ind: 876   |\n|TrustGovernment         |        29|          1.00|FALSE   |        5|Som: 3313, Abo: 2313, Mos: 1016, Nev: 702  |\n|TrustPeople             |        13|          1.00|FALSE   |        5|Mos: 3511, Abo: 2020, Som: 1597, Nev: 264  |\n|AgeGroup                |       294|          0.96|FALSE   |        6|60-: 1436, 70 : 1330, 30-: 1241, 50-: 1200 |\n|Education               |       116|          0.98|FALSE   |        5|Pos: 2514, Bac: 1877, Gra: 1474, Hig: 1160 |\n|RaceEth                 |        81|          0.99|FALSE   |        6|Whi: 5420, His: 662, Bla: 650, Asi: 248    |\n|Gender                  |        51|          0.99|FALSE   |        2|Fem: 4027, Mal: 3375                       |\n|Income                  |       517|          0.93|FALSE   |       22|Und: 647, $50: 485, $10: 451, $25: 405     |\n|Income7                 |       517|          0.93|FALSE   |        7|$12: 1468, Und: 1076, $20: 1051, $40: 984  |\n|VotedPres2020           |      1053|          0.86|FALSE   |        2|Yes: 6313, No: 87                          |\n|VotedPres2020_selection |      1219|          0.84|FALSE   |        3|Bid: 3509, Tru: 2567, Oth: 158             |\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|      mean|        sd|        p0|       p25|       p50|       p75|      p100|hist  |\n|:-------------|---------:|-------------:|---------:|---------:|---------:|---------:|---------:|---------:|---------:|:-----|\n|CaseID        |         0|          1.00| 336416.23| 103653.12| 200015.00| 225427.00| 335416.00| 427865.00| 535469.00|▇▃▃▆▂ |\n|Weight        |         0|          1.00|      1.00|      1.02|      0.01|      0.39|      0.69|      1.21|      6.65|▇▂▁▁▁ |\n|Age           |       294|          0.96|     51.83|     17.14|     18.00|     37.00|     53.00|     66.00|     80.00|▅▇▇▇▇ |\n\n\n:::\n:::\n\n\nResidential energy consumption survey\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"recs_2020\", package = \"srvyrexploR\")\nrecs_2020 %>% \n  select(-matches(\"^NWEIGHT\")) %>% skim()\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |           |\n|:------------------------|:----------|\n|Name                     |Piped data |\n|Number of rows           |18496      |\n|Number of columns        |39         |\n|_______________________  |           |\n|Column type frequency:   |           |\n|character                |2          |\n|factor                   |10         |\n|logical                  |2          |\n|numeric                  |25         |\n|________________________ |           |\n|Group variables          |None       |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|REGIONC       |         0|             1|   4|   9|     0|        4|          0|\n|STATE_FIPS    |         0|             1|   2|   2|     0|       51|          0|\n\n\n**Variable type: factor**\n\n|skim_variable    | n_missing| complete_rate|ordered | n_unique|top_counts                                  |\n|:----------------|---------:|-------------:|:-------|--------:|:-------------------------------------------|\n|ClimateRegion_BA |         0|          1.00|FALSE   |        8|Col: 7116, Mix: 5579, Hot: 2545, Hot: 1577  |\n|Urbanicity       |         0|          1.00|FALSE   |        3|Urb: 12395, Rur: 4081, Urb: 2020            |\n|Region           |         0|          1.00|FALSE   |        4|Sou: 6426, Wes: 4581, Mid: 3832, Nor: 3657  |\n|Division         |         0|          1.00|FALSE   |       10|Sou: 3256, Pac: 2497, Eas: 2014, Mid: 1977  |\n|state_postal     |         0|          1.00|FALSE   |       51|CA: 1152, TX: 1016, NY: 904, FL: 655        |\n|state_name       |         0|          1.00|FALSE   |       51|Cal: 1152, Tex: 1016, New: 904, Flo: 655    |\n|HousingUnitType  |         0|          1.00|FALSE   |        5|Sin: 12319, Apa: 2439, Sin: 1751, Apa: 1013 |\n|YearMade         |         0|          1.00|TRUE    |        9|197: 2817, 200: 2748, Bef: 2721, 199: 2451  |\n|HeatingBehavior  |       751|          0.96|FALSE   |        6|Set: 7806, Man: 4654, Pro: 3310, Tur: 1491  |\n|ACBehavior       |      2325|          0.87|FALSE   |        6|Set: 6738, Man: 3637, Tur: 2746, Pro: 2638  |\n\n\n**Variable type: logical**\n\n|skim_variable    | n_missing| complete_rate| mean|count                 |\n|:----------------|---------:|-------------:|----:|:---------------------|\n|SpaceHeatingUsed |         0|             1| 0.96|TRU: 17745, FAL: 751  |\n|ACUsed           |         0|             1| 0.87|TRU: 16171, FAL: 2325 |\n\n\n**Variable type: numeric**\n\n|skim_variable   | n_missing| complete_rate|      mean|       sd|        p0|       p25|       p50|       p75|       p100|hist  |\n|:---------------|---------:|-------------:|---------:|--------:|---------:|---------:|---------:|---------:|----------:|:-----|\n|DOEID           |         0|          1.00| 109248.50|  5339.48| 100001.00| 104624.75| 109248.50| 113872.25|  118496.00|▇▇▇▇▇ |\n|HDD65           |         0|          1.00|   4271.81|  2329.46|      0.00|   2433.75|   4396.50|   5810.25|   17383.00|▆▇▂▁▁ |\n|CDD65           |         0|          1.00|   1525.52|  1143.24|      0.00|    814.00|   1179.00|   1805.00|    5534.00|▇▆▂▁▁ |\n|HDD30YR         |         0|          1.00|   4679.41|  2338.52|      0.00|   2897.75|   4825.00|   6290.00|   16071.00|▅▇▃▁▁ |\n|CDD30YR         |         0|          1.00|   1309.88|   988.47|      0.00|    601.00|   1020.00|   1703.00|    4905.00|▇▅▂▁▁ |\n|TOTSQFT_EN      |         0|          1.00|   1959.97|  1164.97|    200.00|   1100.00|   1700.00|   2510.00|   15000.00|▇▁▁▁▁ |\n|TOTHSQFT        |         0|          1.00|   1744.46|  1106.33|      0.00|   1000.00|   1520.00|   2300.00|   15000.00|▇▁▁▁▁ |\n|TOTCSQFT        |         0|          1.00|   1393.57|  1168.31|      0.00|    460.00|   1200.00|   2000.00|   14600.00|▇▁▁▁▁ |\n|WinterTempDay   |       751|          0.96|     69.77|     3.62|     50.00|     68.00|     70.00|     72.00|      90.00|▁▁▇▁▁ |\n|WinterTempAway  |       751|          0.96|     67.45|     5.02|     50.00|     65.00|     68.00|     70.00|      90.00|▁▅▇▁▁ |\n|WinterTempNight |       751|          0.96|     68.01|     4.66|     50.00|     65.00|     68.00|     70.00|      90.00|▁▃▇▁▁ |\n|SummerTempDay   |      2325|          0.87|     72.01|     4.74|     50.00|     70.00|     72.00|     75.00|      90.00|▁▁▇▃▁ |\n|SummerTempAway  |      2325|          0.87|     73.45|     5.68|     50.00|     70.00|     74.00|     78.00|      90.00|▁▁▇▇▁ |\n|SummerTempNight |      2325|          0.87|     71.22|     4.80|     50.00|     68.00|     72.00|     74.00|      90.00|▁▂▇▃▁ |\n|BTUEL           |         0|          1.00|  37016.17| 24265.34|    143.32|  20205.76|  31890.03|  48297.98|  628155.47|▇▁▁▁▁ |\n|DOLLAREL        |         0|          1.00|   1424.81|   862.08|   -889.48|    836.49|   1257.86|   1818.95|   15680.18|▇▁▁▁▁ |\n|BTUNG           |         0|          1.00|  36960.50| 46538.32|      0.00|      0.00|  22011.97|  62714.20| 1134708.69|▇▁▁▁▁ |\n|DOLLARNG        |         0|          1.00|    396.05|   483.41|      0.00|      0.00|    313.86|    644.93|    8154.98|▇▁▁▁▁ |\n|BTULP           |         0|          1.00|   3916.95| 16741.93|      0.00|      0.00|      0.00|      0.00|  364215.39|▇▁▁▁▁ |\n|DOLLARLP        |         0|          1.00|     80.89|   333.79|      0.00|      0.00|      0.00|      0.00|    6621.44|▇▁▁▁▁ |\n|BTUFO           |         0|          1.00|   5108.60| 22698.98|      0.00|      0.00|      0.00|      0.00|  426268.50|▇▁▁▁▁ |\n|DOLLARFO        |         0|          1.00|     88.43|   395.97|      0.00|      0.00|      0.00|      0.00|    7003.69|▇▁▁▁▁ |\n|BTUWOOD         |         0|          1.00|   3596.49| 17766.37|      0.00|      0.00|      0.00|      0.00|  500000.00|▇▁▁▁▁ |\n|TOTALBTU        |         0|          1.00|  83002.29| 53206.00|   1182.22|  45565.16|  74180.11| 108535.02| 1367548.13|▇▁▁▁▁ |\n|TOTALDOL        |         0|          1.00|   1990.17|  1108.99|   -150.51|   1258.32|   1793.20|   2472.00|   20043.41|▇▁▁▁▁ |\n\n\n:::\n:::\n\n\nNumeric vars\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_2020 %>% select(where(is.numeric)) %>% colnames()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"DOEID\"           \"HDD65\"           \"CDD65\"           \"HDD30YR\"        \n [5] \"CDD30YR\"         \"TOTSQFT_EN\"      \"TOTHSQFT\"        \"TOTCSQFT\"       \n [9] \"WinterTempDay\"   \"WinterTempAway\"  \"WinterTempNight\" \"SummerTempDay\"  \n[13] \"SummerTempAway\"  \"SummerTempNight\" \"NWEIGHT\"         \"NWEIGHT1\"       \n[17] \"NWEIGHT2\"        \"NWEIGHT3\"        \"NWEIGHT4\"        \"NWEIGHT5\"       \n[21] \"NWEIGHT6\"        \"NWEIGHT7\"        \"NWEIGHT8\"        \"NWEIGHT9\"       \n[25] \"NWEIGHT10\"       \"NWEIGHT11\"       \"NWEIGHT12\"       \"NWEIGHT13\"      \n[29] \"NWEIGHT14\"       \"NWEIGHT15\"       \"NWEIGHT16\"       \"NWEIGHT17\"      \n[33] \"NWEIGHT18\"       \"NWEIGHT19\"       \"NWEIGHT20\"       \"NWEIGHT21\"      \n[37] \"NWEIGHT22\"       \"NWEIGHT23\"       \"NWEIGHT24\"       \"NWEIGHT25\"      \n[41] \"NWEIGHT26\"       \"NWEIGHT27\"       \"NWEIGHT28\"       \"NWEIGHT29\"      \n[45] \"NWEIGHT30\"       \"NWEIGHT31\"       \"NWEIGHT32\"       \"NWEIGHT33\"      \n[49] \"NWEIGHT34\"       \"NWEIGHT35\"       \"NWEIGHT36\"       \"NWEIGHT37\"      \n[53] \"NWEIGHT38\"       \"NWEIGHT39\"       \"NWEIGHT40\"       \"NWEIGHT41\"      \n[57] \"NWEIGHT42\"       \"NWEIGHT43\"       \"NWEIGHT44\"       \"NWEIGHT45\"      \n[61] \"NWEIGHT46\"       \"NWEIGHT47\"       \"NWEIGHT48\"       \"NWEIGHT49\"      \n[65] \"NWEIGHT50\"       \"NWEIGHT51\"       \"NWEIGHT52\"       \"NWEIGHT53\"      \n[69] \"NWEIGHT54\"       \"NWEIGHT55\"       \"NWEIGHT56\"       \"NWEIGHT57\"      \n[73] \"NWEIGHT58\"       \"NWEIGHT59\"       \"NWEIGHT60\"       \"BTUEL\"          \n[77] \"DOLLAREL\"        \"BTUNG\"           \"DOLLARNG\"        \"BTULP\"          \n[81] \"DOLLARLP\"        \"BTUFO\"           \"DOLLARFO\"        \"BTUWOOD\"        \n[85] \"TOTALBTU\"        \"TOTALDOL\"       \n```\n\n\n:::\n:::\n\n\nAmerican national election studies design object\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncps_state_in <- getCensus(\n  name = \"cps/basic/mar\",\n  vintage = 2020,\n  region = \"state\",\n  vars = c(\n    \"HRMONTH\", \"HRYEAR4\",\n    \"PRTAGE\", \"PRCITSHP\", \"PWSSWGT\"\n  ),\n  key = Sys.getenv(\"CENSUS_KEY\")\n)\n\ncps_state <- cps_state_in %>%\n  as_tibble() %>%\n  mutate(\n    across(\n      .cols = everything(),\n      .fns = as.numeric\n    )\n  )\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncps_narrow_resp <- cps_state %>%\n  filter(\n    PRTAGE >= 18,\n    PRCITSHP %in% c(1:4)\n  )\n```\n:::\n\n\nCalculate use population from the narrow data. Weights should add to total pop.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntargetpop <- cps_narrow_resp %>% \n  pull(PWSSWGT) %>%\n  sum()\nscales::comma(targetpop)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"231,034,125\"\n```\n\n\n:::\n:::\n\n\nWe can the weight the us election study appropriately\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanes_adjwgt <- anes_2020 %>%\n  mutate(\n    weight = V200010b / sum(V200010b) * targetpop\n  )\n```\n:::\n\n\nWe then make it conform to a survey design\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanes_des <- anes_adjwgt %>%\n  as_survey_design(\n    weights = weight,\n    strata = V200010d,\n    ids = V200010c,\n    nest = TRUE\n  )\nanes_des\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nStratified 1 - level Cluster Sampling design (with replacement)\nWith (101) clusters.\nCalled via srvyr\nSampling variables:\n  - ids: V200010c \n  - strata: V200010d \n  - weights: weight \nData variables: \n  - V200001 (dbl), CaseID (dbl), V200002 (hvn_lbll), InterviewMode (fct),\n    V200010b (dbl), Weight (dbl), V200010c (dbl), VarUnit (fct), V200010d\n    (dbl), Stratum (fct), V201006 (hvn_lbll), CampaignInterest (fct), V201023\n    (hvn_lbll), EarlyVote2020 (fct), V201024 (hvn_lbll), V201025x (hvn_lbll),\n    V201028 (hvn_lbll), V201029 (hvn_lbll), V201101 (hvn_lbll), V201102\n    (hvn_lbll), VotedPres2016 (fct), V201103 (hvn_lbll),\n    VotedPres2016_selection (fct), V201228 (hvn_lbll), V201229 (hvn_lbll),\n    V201230 (hvn_lbll), V201231x (hvn_lbll), PartyID (fct), V201233 (hvn_lbll),\n    TrustGovernment (fct), V201237 (hvn_lbll), TrustPeople (fct), V201507x\n    (hvn_lbll), Age (dbl), AgeGroup (fct), V201510 (hvn_lbll), Education (fct),\n    V201546 (hvn_lbll), V201547a (hvn_lbll), V201547b (hvn_lbll), V201547c\n    (hvn_lbll), V201547d (hvn_lbll), V201547e (hvn_lbll), V201547z (hvn_lbll),\n    V201549x (hvn_lbll), RaceEth (fct), V201600 (hvn_lbll), Gender (fct),\n    V201607 (hvn_lbll), V201610 (hvn_lbll), V201611 (hvn_lbll), V201613\n    (hvn_lbll), V201615 (hvn_lbll), V201616 (hvn_lbll), V201617x (hvn_lbll),\n    Income (fct), Income7 (fct), V202051 (hvn_lbll), V202066 (hvn_lbll),\n    V202072 (hvn_lbll), VotedPres2020 (fct), V202073 (hvn_lbll), V202109x\n    (hvn_lbll), V202110x (hvn_lbll), VotedPres2020_selection (fct), weight\n    (dbl)\n```\n\n\n:::\n:::\n\n\nUsing replicated weights\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_des <- recs_2020 %>%\n  as_survey_rep(\n    weights = NWEIGHT,\n    repweights = NWEIGHT1:NWEIGHT60,\n    type = \"JK1\",\n    scale = 59 / 60,\n    mse = TRUE\n  )\n\nrecs_des\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall: Called via srvyr\nUnstratified cluster jacknife (JK1) with 60 replicates and MSE variances.\nSampling variables:\n  - repweights: `NWEIGHT1 + NWEIGHT2 + NWEIGHT3 + NWEIGHT4 + NWEIGHT5 +\n    NWEIGHT6 + NWEIGHT7 + NWEIGHT8 + NWEIGHT9 + NWEIGHT10 + NWEIGHT11 +\n    NWEIGHT12 + NWEIGHT13 + NWEIGHT14 + NWEIGHT15 + NWEIGHT16 + NWEIGHT17 +\n    NWEIGHT18 + NWEIGHT19 + NWEIGHT20 + NWEIGHT21 + NWEIGHT22 + NWEIGHT23 +\n    NWEIGHT24 + NWEIGHT25 + NWEIGHT26 + NWEIGHT27 + NWEIGHT28 + NWEIGHT29 +\n    NWEIGHT30 + NWEIGHT31 + NWEIGHT32 + NWEIGHT33 + NWEIGHT34 + NWEIGHT35 +\n    NWEIGHT36 + NWEIGHT37 + NWEIGHT38 + NWEIGHT39 + NWEIGHT40 + NWEIGHT41 +\n    NWEIGHT42 + NWEIGHT43 + NWEIGHT44 + NWEIGHT45 + NWEIGHT46 + NWEIGHT47 +\n    NWEIGHT48 + NWEIGHT49 + NWEIGHT50 + NWEIGHT51 + NWEIGHT52 + NWEIGHT53 +\n    NWEIGHT54 + NWEIGHT55 + NWEIGHT56 + NWEIGHT57 + NWEIGHT58 + NWEIGHT59 +\n    NWEIGHT60` \n  - weights: NWEIGHT \nData variables: \n  - DOEID (dbl), ClimateRegion_BA (fct), Urbanicity (fct), Region (fct),\n    REGIONC (chr), Division (fct), STATE_FIPS (chr), state_postal (fct),\n    state_name (fct), HDD65 (dbl), CDD65 (dbl), HDD30YR (dbl), CDD30YR (dbl),\n    HousingUnitType (fct), YearMade (ord), TOTSQFT_EN (dbl), TOTHSQFT (dbl),\n    TOTCSQFT (dbl), SpaceHeatingUsed (lgl), ACUsed (lgl), HeatingBehavior\n    (fct), WinterTempDay (dbl), WinterTempAway (dbl), WinterTempNight (dbl),\n    ACBehavior (fct), SummerTempDay (dbl), SummerTempAway (dbl),\n    SummerTempNight (dbl), NWEIGHT (dbl), NWEIGHT1 (dbl), NWEIGHT2 (dbl),\n    NWEIGHT3 (dbl), NWEIGHT4 (dbl), NWEIGHT5 (dbl), NWEIGHT6 (dbl), NWEIGHT7\n    (dbl), NWEIGHT8 (dbl), NWEIGHT9 (dbl), NWEIGHT10 (dbl), NWEIGHT11 (dbl),\n    NWEIGHT12 (dbl), NWEIGHT13 (dbl), NWEIGHT14 (dbl), NWEIGHT15 (dbl),\n    NWEIGHT16 (dbl), NWEIGHT17 (dbl), NWEIGHT18 (dbl), NWEIGHT19 (dbl),\n    NWEIGHT20 (dbl), NWEIGHT21 (dbl), NWEIGHT22 (dbl), NWEIGHT23 (dbl),\n    NWEIGHT24 (dbl), NWEIGHT25 (dbl), NWEIGHT26 (dbl), NWEIGHT27 (dbl),\n    NWEIGHT28 (dbl), NWEIGHT29 (dbl), NWEIGHT30 (dbl), NWEIGHT31 (dbl),\n    NWEIGHT32 (dbl), NWEIGHT33 (dbl), NWEIGHT34 (dbl), NWEIGHT35 (dbl),\n    NWEIGHT36 (dbl), NWEIGHT37 (dbl), NWEIGHT38 (dbl), NWEIGHT39 (dbl),\n    NWEIGHT40 (dbl), NWEIGHT41 (dbl), NWEIGHT42 (dbl), NWEIGHT43 (dbl),\n    NWEIGHT44 (dbl), NWEIGHT45 (dbl), NWEIGHT46 (dbl), NWEIGHT47 (dbl),\n    NWEIGHT48 (dbl), NWEIGHT49 (dbl), NWEIGHT50 (dbl), NWEIGHT51 (dbl),\n    NWEIGHT52 (dbl), NWEIGHT53 (dbl), NWEIGHT54 (dbl), NWEIGHT55 (dbl),\n    NWEIGHT56 (dbl), NWEIGHT57 (dbl), NWEIGHT58 (dbl), NWEIGHT59 (dbl),\n    NWEIGHT60 (dbl), BTUEL (dbl), DOLLAREL (dbl), BTUNG (dbl), DOLLARNG (dbl),\n    BTULP (dbl), DOLLARLP (dbl), BTUFO (dbl), DOLLARFO (dbl), BTUWOOD (dbl),\n    TOTALBTU (dbl), TOTALDOL (dbl)\n```\n\n\n:::\n:::\n\n\n## Descriptive statisitcs\n\n* Count observations with `survey_count()` or `survey_tally()`\n* Sum variables with `survey_total()`\n* Means and proportions: `survey_mean()`, `survey_prop()`\n* Quantiles and medians: `survey_quantile()`, `survey_median()`\n* Correlations: `survey_cor()`\n* Ratios: `survey_ratio()`\n* Variances and standard deviation: `survey_var()`, `survey_sd()`\n\n### Counts and cross-tabulations\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_des %>% survey_tally()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 2\n           n  n_se\n       <dbl> <dbl>\n1 123529025. 0.148\n```\n\n\n:::\n:::\n\n\nEstimated counts by subgroups\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_des %>% survey_count(Region, Division, name = \"N\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 4\n   Region    Division                   N         N_se\n   <fct>     <fct>                  <dbl>        <dbl>\n 1 Northeast New England         5876166  0.0000000137\n 2 Northeast Middle Atlantic    16043503  0.0000000487\n 3 Midwest   East North Central 18546912  0.000000437 \n 4 Midwest   West North Central  8495815  0.0000000177\n 5 South     South Atlantic     24843261  0.0000000418\n 6 South     East South Central  7380717. 0.114       \n 7 South     West South Central 14619094  0.000488    \n 8 West      Mountain North      4615844  0.119       \n 9 West      Mountain South      4602070  0.0000000492\n10 West      Pacific            18505643. 0.00000295  \n```\n\n\n:::\n:::\n\n\nTo achieve same result by `survey_tally()`, you first group\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_des %>% group_by(Region, Division) %>% survey_tally(name = \"N\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 4\n# Groups:   Region [4]\n   Region    Division                   N         N_se\n   <fct>     <fct>                  <dbl>        <dbl>\n 1 Northeast New England         5876166  0.0000000137\n 2 Northeast Middle Atlantic    16043503  0.0000000487\n 3 Midwest   East North Central 18546912  0.000000437 \n 4 Midwest   West North Central  8495815  0.0000000177\n 5 South     South Atlantic     24843261  0.0000000418\n 6 South     East South Central  7380717. 0.114       \n 7 South     West South Central 14619094  0.000488    \n 8 West      Mountain North      4615844  0.119       \n 9 West      Mountain South      4602070  0.0000000492\n10 West      Pacific            18505643. 0.00000295  \n```\n\n\n:::\n:::\n\n\n### Totals and sums\n\nTo get population count estimate, we leave argument `x`, empty.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_des %>% \n  summarize(\n    tot = survey_total()\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 2\n         tot tot_se\n       <dbl>  <dbl>\n1 123529025.  0.148\n```\n\n\n:::\n:::\n\n\nOverall summation of a continuous variable\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_des %>%\n  summarize(elec_bill = survey_total(DOLLAREL))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 2\n      elec_bill elec_bill_se\n          <dbl>        <dbl>\n1 170473527909.   664893504.\n```\n\n\n:::\n:::\n\n\nSummation by groups\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_des %>% group_by(Region) %>%\n  summarize(\n  elec_bill = survey_total(DOLLAREL, vartype = \"ci\")\n  \n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 4\n  Region       elec_bill elec_bill_low elec_bill_upp\n  <fct>            <dbl>         <dbl>         <dbl>\n1 Northeast 29430369947.  28788987554.  30071752341.\n2 Midwest   34972544751.  34339576041.  35605513460.\n3 South     72496840204.  71534780902.  73458899506.\n4 West      33573773008.  32909111702.  34238434313.\n```\n\n\n:::\n:::\n\n\nYou can supply `.by` argument inside `summarize`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_des  %>%\n  summarize(\n  elec_bill = survey_total(DOLLAREL, vartype = \"ci\"),\n  .by = Region\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 4\n  Region       elec_bill elec_bill_low elec_bill_upp\n  <fct>            <dbl>         <dbl>         <dbl>\n1 Northeast 29430369947.  28788987554.  30071752341.\n2 Midwest   34972544751.  34339576041.  35605513460.\n3 South     72496840204.  71534780902.  73458899506.\n4 West      33573773008.  32909111702.  34238434313.\n```\n\n\n:::\n:::\n\n\n### Means and proportions\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_des %>% group_by(Region, ACUsed) %>%\n  summarise(\n  p = survey_prop()\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWhen `proportion` is unspecified, `survey_prop()` now defaults to `proportion = TRUE`.\nℹ This should improve confidence interval coverage.\nThis message is displayed once per session.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 8 × 4\n# Groups:   Region [4]\n  Region    ACUsed      p    p_se\n  <fct>     <lgl>   <dbl>   <dbl>\n1 Northeast FALSE  0.110  0.00590\n2 Northeast TRUE   0.890  0.00590\n3 Midwest   FALSE  0.0666 0.00508\n4 Midwest   TRUE   0.933  0.00508\n5 South     FALSE  0.0581 0.00278\n6 South     TRUE   0.942  0.00278\n7 West      FALSE  0.255  0.00759\n8 West      TRUE   0.745  0.00759\n```\n\n\n:::\n:::\n\n\nJoint proportions using `interact`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_des %>% \n  group_by(\n    interact(Region, ACUsed)\n  ) %>% \n  summarize(\n    p = survey_prop() \n  ) %>% mutate(\n    p = scales::percent(p)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 8 × 4\n  Region    ACUsed p         p_se\n  <fct>     <lgl>  <chr>    <dbl>\n1 Northeast FALSE  1.96%  0.00105\n2 Northeast TRUE   15.79% 0.00105\n3 Midwest   FALSE  1.46%  0.00111\n4 Midwest   TRUE   20.43% 0.00111\n5 South     FALSE  2.20%  0.00106\n6 South     TRUE   35.72% 0.00106\n7 West      FALSE  5.73%  0.00170\n8 West      TRUE   16.72% 0.00170\n```\n\n\n:::\n:::\n\n\nOverall mean\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_des %>% summarize(\n  elec_bill = survey_mean(DOLLAREL, vartype = c(\"se\", \"ci\"))\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 4\n  elec_bill elec_bill_se elec_bill_low elec_bill_upp\n      <dbl>        <dbl>         <dbl>         <dbl>\n1     1380.         5.38         1369.         1391.\n```\n\n\n:::\n:::\n\n\n### Quantiles and Medians\n\nOverall quantiles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_des %>%\n  summarize(\n    elec_bill = survey_quantile(DOLLAREL, quantiles = c(.25, .5, .75))\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 6\n  elec_bill_q25 elec_bill_q50 elec_bill_q75 elec_bill_q25_se elec_bill_q50_se\n          <dbl>         <dbl>         <dbl>            <dbl>            <dbl>\n1          795.         1215.         1770.             5.69             6.33\n# ℹ 1 more variable: elec_bill_q75_se <dbl>\n```\n\n\n:::\n:::\n\n\nOverall median\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_des %>%\n  summarize(\n    elec_bill = survey_median(DOLLAREL)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 2\n  elec_bill elec_bill_se\n      <dbl>        <dbl>\n1     1215.         6.33\n```\n\n\n:::\n:::\n\n\nCorrelations\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_des %>%\n  summarize(SQFT_Elec_Corr = survey_corr(TOTSQFT_EN, BTUEL))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: There was 1 warning in `dplyr::summarise()`.\nℹ In argument: `SQFT_Elec_Corr = survey_corr(TOTSQFT_EN, BTUEL)`.\nCaused by warning in `sweep()`:\n! length(STATS) or dim(STATS) do not match dim(x)[MARGIN]\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 2\n  SQFT_Elec_Corr SQFT_Elec_Corr_se\n           <dbl>             <dbl>\n1          0.417           0.00689\n```\n\n\n:::\n:::\n\n\n#### Design effects\n\nDesign effect measures the precision of an estimate under a particular sampling\ndesign relative to a simple random sampling design. If <1, the design is \nstatistically more efficient than SRS. It is used in the calculation of \neffective sample size - the sample size needed if we were to employ SRS\n\n$$n_{eff} = \\frac{n}{D_{eff}}$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_des %>%\n  summarize(\n    across(\n          c(BTUEL, BTUNG, BTULP, BTUFO, BTUWOOD),\n          ~ survey_mean(.x, deff = TRUE, vartype = NULL)\n    )\n  ) %>% select(ends_with(\"deff\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 5\n  BTUEL_deff BTUNG_deff BTULP_deff BTUFO_deff BTUWOOD_deff\n       <dbl>      <dbl>      <dbl>      <dbl>        <dbl>\n1      0.597      0.938       1.21      0.720         1.10\n```\n\n\n:::\n:::\n\n\n#### Creating cascading rows - `cascade`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_des %>%\n  cascade(DOLLAREL_mn = survey_mean(DOLLAREL))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 2\n  DOLLAREL_mn DOLLAREL_mn_se\n        <dbl>          <dbl>\n1       1380.           5.38\n```\n\n\n:::\n:::\n\n\nGroup\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_des %>%\n  group_by(Region) %>%\n  cascade(DOLLAREL_mn = survey_mean(DOLLAREL), .fill = \"National\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 3\n  Region    DOLLAREL_mn DOLLAREL_mn_se\n  <fct>           <dbl>          <dbl>\n1 Northeast       1343.          14.6 \n2 Midwest         1293.          11.7 \n3 South           1548.          10.3 \n4 West            1211.          12.0 \n5 National        1380.           5.38\n```\n\n\n:::\n:::\n\n\nOr through a long dplyr pipeline\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_des %>% \n  summarize(\n    cons_mean = survey_mean(DOLLAREL),\n    .by = Region\n  ) %>% bind_rows(\n    ., recs_des %>%\n      summarize(\n        cons_mean = survey_mean(DOLLAREL)\n      ) %>% mutate(\n        ., Region = \"National\"\n      ) %>% select(Region, everything())\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 3\n  Region    cons_mean cons_mean_se\n  <chr>         <dbl>        <dbl>\n1 Northeast     1343.        14.6 \n2 Midwest       1293.        11.7 \n3 South         1548.        10.3 \n4 West          1211.        12.0 \n5 National      1380.         5.38\n```\n\n\n:::\n:::\n\n\n#### Summarize across multiple variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_des %>% \n  summarize(\n    across(\n      starts_with(\"BTU\"),\n      list(\n        Total = ~ survey_total(.x, vartype = \"cv\"),\n        Mean = ~ survey_mean(.x, vartype = \"cv\")\n      ),\n      .unpack = \"{outer}.{inner}\"\n    )\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 20\n  BTUEL_Total.coef BTUEL_Total._cv BTUEL_Mean.coef BTUEL_Mean._cv\n             <dbl>           <dbl>           <dbl>          <dbl>\n1    4453284510065         0.00377          36051.        0.00377\n# ℹ 16 more variables: BTUNG_Total.coef <dbl>, BTUNG_Total._cv <dbl>,\n#   BTUNG_Mean.coef <dbl>, BTUNG_Mean._cv <dbl>, BTULP_Total.coef <dbl>,\n#   BTULP_Total._cv <dbl>, BTULP_Mean.coef <dbl>, BTULP_Mean._cv <dbl>,\n#   BTUFO_Total.coef <dbl>, BTUFO_Total._cv <dbl>, BTUFO_Mean.coef <dbl>,\n#   BTUFO_Mean._cv <dbl>, BTUWOOD_Total.coef <dbl>, BTUWOOD_Total._cv <dbl>,\n#   BTUWOOD_Mean.coef <dbl>, BTUWOOD_Mean._cv <dbl>\n```\n\n\n:::\n:::\n\n\n#### Map\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncalc <- function(df, var) {\n  df %>%\n    drop_na(!!sym(var)) %>%\n    group_by(!!sym(var)) %>%\n    summarize(p = survey_prop()) %>%\n    mutate(Variable = var) %>%\n    rename(Answer := !!sym(var)) %>%\n    mutate(p = scales::percent(p)) %>%\n    select(Variable, everything())\n}\n\nv <- c(\"TrustGovernment\", \"TrustPeople\")\nmap2(\n  .x = list(anes_des),\n  .y = v,\n  .f = ~calc(df = .x, var = .y)\n) %>% bind_rows()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 4\n   Variable        Answer              p        p_se\n   <chr>           <fct>               <chr>   <dbl>\n 1 TrustGovernment Always              1.6%  0.00204\n 2 TrustGovernment Most of the time    13.2% 0.00553\n 3 TrustGovernment About half the time 30.9% 0.00829\n 4 TrustGovernment Some of the time    43.4% 0.00855\n 5 TrustGovernment Never               11.0% 0.00566\n 6 TrustPeople     Always              0.8%  0.00164\n 7 TrustPeople     Most of the time    41.4% 0.00857\n 8 TrustPeople     About half the time 28.2% 0.00776\n 9 TrustPeople     Some of the time    24.5% 0.00670\n10 TrustPeople     Never               5.0%  0.00422\n```\n\n\n:::\n:::\n\n\n## Statistical testing\n\n* Comparison of means and proportions: `svyttest()`\n* goodness-of-fit test: `svygofchisq()`\n* Test of independence: `svychisq()`\n* Test of homogeneity: `svychisq()`\n\n### Comparison of Means and Proportions\n\n* one-sample t-test: compare to 0 - `var ~ 0` or to a different value `var - val = 0`\n* two-sample t-test: \n    \n    * unpaired: two level grouping variable - `var ~ groupvar` or three level\n    grouping variable - `var ~ groupvar == level`\n    * paired: `var_1 - var_2 = 0`\n  \nExample: one-sample t-test for mean\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_des %>%\n  svyttest(\n    formula = SummerTempNight - 68 ~ 0,\n    design =.,\n    na.rm = TRUE\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tDesign-based one-sample t-test\n\ndata:  SummerTempNight - 68 ~ 0\nt = 84.788, df = 58, p-value < 2.2e-16\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n 3.287816 3.446810\nsample estimates:\n    mean \n3.367313 \n```\n\n\n:::\n:::\n\n\nget mean summer temps at night\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_des %>% \n  summarize(m = survey_mean(SummerTempNight, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 2\n      m   m_se\n  <dbl>  <dbl>\n1  71.4 0.0397\n```\n\n\n:::\n:::\n\n\nExample: one-sample t-test for proportion\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecs_des %>% summarize(\n  p = survey_prop(),\n  .by = ACUsed\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 3\n  ACUsed     p    p_se\n  <lgl>  <dbl>   <dbl>\n1 FALSE  0.113 0.00306\n2 TRUE   0.887 0.00306\n```\n\n\n:::\n:::\n\n\n\n::: {#tbl-ac .cell tbl-cap='One-sample t-test for estimate of US housholds use of A/C in their homes differing from 90%'}\n\n```{.r .cell-code}\nrecs_des %>%\n  svyttest(\n    formula = (ACUsed == TRUE) - 0.90 ~ 0,\n    design = .,\n    na.rm = TRUE\n  ) %>% tidy() %>%\n  mutate(p.value = pretty_p_value(p.value)) %>%\n  gt() %>%\n  fmt_number()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"tcqxdrgtal\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#tcqxdrgtal table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#tcqxdrgtal thead, #tcqxdrgtal tbody, #tcqxdrgtal tfoot, #tcqxdrgtal tr, #tcqxdrgtal td, #tcqxdrgtal th {\n  border-style: none;\n}\n\n#tcqxdrgtal p {\n  margin: 0;\n  padding: 0;\n}\n\n#tcqxdrgtal .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#tcqxdrgtal .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#tcqxdrgtal .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#tcqxdrgtal .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#tcqxdrgtal .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#tcqxdrgtal .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tcqxdrgtal .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#tcqxdrgtal .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#tcqxdrgtal .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#tcqxdrgtal .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#tcqxdrgtal .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#tcqxdrgtal .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#tcqxdrgtal .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#tcqxdrgtal .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#tcqxdrgtal .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#tcqxdrgtal .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#tcqxdrgtal .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#tcqxdrgtal .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#tcqxdrgtal .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tcqxdrgtal .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#tcqxdrgtal .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#tcqxdrgtal .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#tcqxdrgtal .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tcqxdrgtal .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#tcqxdrgtal .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#tcqxdrgtal .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tcqxdrgtal .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tcqxdrgtal .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#tcqxdrgtal .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tcqxdrgtal .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#tcqxdrgtal .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tcqxdrgtal .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#tcqxdrgtal .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tcqxdrgtal .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#tcqxdrgtal .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tcqxdrgtal .gt_left {\n  text-align: left;\n}\n\n#tcqxdrgtal .gt_center {\n  text-align: center;\n}\n\n#tcqxdrgtal .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#tcqxdrgtal .gt_font_normal {\n  font-weight: normal;\n}\n\n#tcqxdrgtal .gt_font_bold {\n  font-weight: bold;\n}\n\n#tcqxdrgtal .gt_font_italic {\n  font-style: italic;\n}\n\n#tcqxdrgtal .gt_super {\n  font-size: 65%;\n}\n\n#tcqxdrgtal .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#tcqxdrgtal .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#tcqxdrgtal .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#tcqxdrgtal .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#tcqxdrgtal .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#tcqxdrgtal .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#tcqxdrgtal .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#tcqxdrgtal .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#tcqxdrgtal div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\">estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"parameter\">parameter</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low\">conf.low</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.high\">conf.high</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"method\">method</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"alternative\">alternative</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"estimate\" class=\"gt_row gt_right\">−0.01</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">−4.40</td>\n<td headers=\"p.value\" class=\"gt_row gt_left\">&lt;0.0001</td>\n<td headers=\"parameter\" class=\"gt_row gt_right\">58.00</td>\n<td headers=\"conf.low\" class=\"gt_row gt_right\">−0.02</td>\n<td headers=\"conf.high\" class=\"gt_row gt_right\">−0.01</td>\n<td headers=\"method\" class=\"gt_row gt_left\">Design-based one-sample t-test</td>\n<td headers=\"alternative\" class=\"gt_row gt_left\">two.sided</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\nExample: paired two-sample t-test\n\n\n::: {#tbl-tmp .cell tbl-cap='Paired two-sample t-test'}\n\n```{.r .cell-code}\nrecs_des %>%\n  svyttest(\n    formula = SummerTempNight - WinterTempNight ~ 0,\n    design = .,\n    na.rm = TRUE\n  ) %>% tidy() %>%\n  mutate(\n    p.value = pretty_p_value(p.value)\n  ) %>%\n  gt() %>%\n  fmt_number()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"uqhszxmdry\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#uqhszxmdry table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#uqhszxmdry thead, #uqhszxmdry tbody, #uqhszxmdry tfoot, #uqhszxmdry tr, #uqhszxmdry td, #uqhszxmdry th {\n  border-style: none;\n}\n\n#uqhszxmdry p {\n  margin: 0;\n  padding: 0;\n}\n\n#uqhszxmdry .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#uqhszxmdry .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#uqhszxmdry .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#uqhszxmdry .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#uqhszxmdry .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#uqhszxmdry .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uqhszxmdry .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#uqhszxmdry .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#uqhszxmdry .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#uqhszxmdry .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#uqhszxmdry .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#uqhszxmdry .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#uqhszxmdry .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#uqhszxmdry .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#uqhszxmdry .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#uqhszxmdry .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#uqhszxmdry .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#uqhszxmdry .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#uqhszxmdry .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uqhszxmdry .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#uqhszxmdry .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#uqhszxmdry .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#uqhszxmdry .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uqhszxmdry .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#uqhszxmdry .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#uqhszxmdry .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uqhszxmdry .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uqhszxmdry .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#uqhszxmdry .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uqhszxmdry .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#uqhszxmdry .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uqhszxmdry .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#uqhszxmdry .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uqhszxmdry .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#uqhszxmdry .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uqhszxmdry .gt_left {\n  text-align: left;\n}\n\n#uqhszxmdry .gt_center {\n  text-align: center;\n}\n\n#uqhszxmdry .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#uqhszxmdry .gt_font_normal {\n  font-weight: normal;\n}\n\n#uqhszxmdry .gt_font_bold {\n  font-weight: bold;\n}\n\n#uqhszxmdry .gt_font_italic {\n  font-style: italic;\n}\n\n#uqhszxmdry .gt_super {\n  font-size: 65%;\n}\n\n#uqhszxmdry .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#uqhszxmdry .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#uqhszxmdry .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#uqhszxmdry .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#uqhszxmdry .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#uqhszxmdry .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#uqhszxmdry .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#uqhszxmdry .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#uqhszxmdry div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\">estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"parameter\">parameter</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low\">conf.low</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.high\">conf.high</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"method\">method</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"alternative\">alternative</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"estimate\" class=\"gt_row gt_right\">2.85</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">50.83</td>\n<td headers=\"p.value\" class=\"gt_row gt_left\">&lt;0.0001</td>\n<td headers=\"parameter\" class=\"gt_row gt_right\">58.00</td>\n<td headers=\"conf.low\" class=\"gt_row gt_right\">2.74</td>\n<td headers=\"conf.high\" class=\"gt_row gt_right\">2.96</td>\n<td headers=\"method\" class=\"gt_row gt_left\">Design-based one-sample t-test</td>\n<td headers=\"alternative\" class=\"gt_row gt_left\">two.sided</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n### Chi-squared tests\n\nSee <https://tidy-survey-r.github.io/tidy-survey-book/c06-statistical-testing.html>\n\nExample: goodness of fit test\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanes_des_educ <- anes_des %>%\n  mutate(\n    Education2 = fct_collapse(Education,\n      \"Bachelor or Higher\" = c(\"Bachelor's\", \"Graduate\")\n    )\n  )\n\nanes_des_educ %>%\n  drop_na(Education2) %>%\n  group_by(Education2) %>% \n  summarize(p = survey_mean())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 3\n  Education2              p    p_se\n  <fct>               <dbl>   <dbl>\n1 Less than HS       0.0805 0.00568\n2 High school        0.277  0.0102 \n3 Post HS            0.290  0.00713\n4 Bachelor or Higher 0.352  0.00732\n```\n\n\n:::\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanes_des_educ %>%\n  svygofchisq(\n    formula = ~Education2,\n    design = .,\n    p = c(0.11, 0.27, 0.28, 0.35),\n    na.rm = TRUE\n  ) %>% tidy()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nMultiple parameters; naming those columns scale and df.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 5\n    scale    df statistic  p.value method                                       \n    <dbl> <dbl>     <dbl>    <dbl> <chr>                                        \n1 113213.  2.26  1922280. 0.000292 Design-based chi-squared test for given prob…\n```\n\n\n:::\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nex1_table <- anes_des_educ %>%\n  drop_na(Education2) %>%\n  group_by(Education2) %>%\n  summarize(Observed = survey_mean(vartype = \"ci\")) %>%\n  rename(Education = Education2) %>%\n  mutate(Expected = c(0.11, 0.27, 0.29, 0.33)) %>%\n  select(Education, Expected, everything())\n\nex1_table\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 5\n  Education          Expected Observed Observed_low Observed_upp\n  <fct>                 <dbl>    <dbl>        <dbl>        <dbl>\n1 Less than HS           0.11   0.0805       0.0691       0.0919\n2 High school            0.27   0.277        0.257        0.298 \n3 Post HS                0.29   0.290        0.276        0.305 \n4 Bachelor or Higher     0.33   0.352        0.337        0.367 \n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nex1_table %>%\n  pivot_longer(\n    cols = c(\"Expected\", \"Observed\"),\n    names_to = \"Names\",\n    values_to = \"Proportion\"\n  ) %>%\n  mutate(\n    Observed_low = if_else(Names == \"Observed\", Observed_low, NA_real_),\n    Observed_upp = if_else(Names == \"Observed\", Observed_upp, NA_real_),\n    Names = if_else(Names == \"Observed\",\n      \"ANES (observed)\", \"ACS (expected)\"\n    )\n  ) %>%\n  ggplot(aes(x = Education, y = Proportion, color = Names)) +\n  geom_point(alpha = 0.75, size = 2) +\n  geom_errorbar(aes(ymin = Observed_low, ymax = Observed_upp),\n    width = 0.25\n  ) +\n  theme_bw() +\n  # scale_color_manual(name = \"Type\", values = book_colors[c(4, 1)]) +\n  theme(legend.position = \"bottom\", legend.title = element_blank())\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-37-1.png){width=672}\n:::\n:::\n\n\n\n# Sampling Designs and replicate weights\n\n### SRS \n\n#### SRS without replacement\n\nWhen we sample without replacement, we use finite population correction in the \nestimation of standard error of estimates\n\n$$fpc = \\sqrt{\\frac{N-n}{N-1}} \\simeq \\sqrt{1 - \\frac{n}{N}}$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(as.numeric(Sys.time()))\n\ndata(\"api\", package = \"survey\")\n\napisrs_slim <-\n  apisrs %>%\n  as_tibble() %>%\n  arrange(dnum, snum) %>%\n  select(cds, dnum, snum, dname, sname, fpc, pw)\n\napisrs_slim\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 200 × 7\n   cds             dnum  snum dname                   sname            fpc    pw\n   <chr>          <int> <dbl> <chr>                   <chr>          <dbl> <dbl>\n 1 19642126061220     1  1121 ABC Unified             Haskell (Plin…  6194  31.0\n 2 19642126066716     1  1124 ABC Unified             Stowers (Ceci…  6194  31.0\n 3 36675876035174     5  3895 Adelanto Elementary     Adelanto Elem…  6194  31.0\n 4 33669776031512    19  3347 Alvord Unified          Arlanza Eleme…  6194  31.0\n 5 33669776031595    19  3352 Alvord Unified          Wells Interme…  6194  31.0\n 6 31667876031033    39  3271 Auburn Union Elementary Cain (E.V.) M…  6194  31.0\n 7 19642876011407    42  1169 Baldwin Park Unified    Deanza Elemen…  6194  31.0\n 8 19642876011464    42  1175 Baldwin Park Unified    Heath (Margar…  6194  31.0\n 9 19642956011589    48  1187 Bassett Unified         Erwin (Thomas…  6194  31.0\n10 41688586043392    49  4948 Bayshore Elementary     Bayshore Elem…  6194  31.0\n# ℹ 190 more rows\n```\n\n\n:::\n:::\n\n\nCreate a `tbl_survey` object\n\n\n::: {.cell}\n\n```{.r .cell-code}\napisrs_des <- apisrs_slim %>%\n  as_survey_design(\n    weights = pw,\n    fpc = fpc\n  )\napisrs_des\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nIndependent Sampling design\nCalled via srvyr\nSampling variables:\n  - ids: `1` \n  - fpc: fpc \n  - weights: pw \nData variables: \n  - cds (chr), dnum (int), snum (dbl), dname (chr), sname (chr), fpc (dbl), pw\n    (dbl)\n```\n\n\n:::\n:::\n\n\n### SRS with replacement\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(as.numeric(Sys.time()))\n\napisrswr <- apipop %>%\n  as_tibble() %>%\n  slice_sample(n = 200, replace = TRUE) %>%\n  select(cds, dnum, snum, dname, sname) %>%\n  mutate(weight = nrow(apipop) / 200)\n\nhead(apisrswr)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 6\n  cds             dnum  snum dname                sname                   weight\n  <chr>          <int> <dbl> <chr>                <chr>                    <dbl>\n1 19647256015432   395  1498 Long Beach Unified   Lee Elementary            31.0\n2 30664643030210   108  2876 Capistrano Unified   Capistrano Valley High    31.0\n3 34752836033328   480  3880 Natomas Unified      Greene (Leroy F.) Midd…   31.0\n4 34674216112296   606  3728 Robla Elementary     Glenwood Elementary       31.0\n5 01611430131177    60    21 Berkeley Unified     Berkeley High             31.0\n6 36676866035729   148  3981 Colton Joint Unified Zimmerman (Walter) Ele…   31.0\n```\n\n\n:::\n:::\n\n\n## Statified Sampling\n\nPopulation can be grouped into homogeneous units (strata). Random samples are then drawn\nfrom each of the units.\n\nIf $\\hat{y}_h$ is the sample mean for stratum $h$, $N_h$ the population size of \nstratum $h$, and $H$ the total number of strata, then estimates of the mean\n\n$$\\hat{y} = \\frac{1}{N}\\sum_{h=1}^H N_h \\hat{y}_h$$ \nand \n\n$$se(\\hat{y}) = \\sqrt{\\frac{1}{N^2}\\sum_{h=1}^H N^2_h \\frac{s^2_h}{n_h}(1 - \\frac{n_h}{N_h})}$$\nwhere\n\n$$s^2_h = \\frac{1}{n_h - 1} \\sum_{i=1}^{n_h}(y_{i,h} - \\hat{y_h})^2$$\nand proportion\n\n$$\\hat{p} = \\frac{1}{N} \\sum_{h=1}^H N_h \\hat{p}_h$$\n\n$$se(\\hat{p}) = \\frac{1}{N}\\sqrt{\\sum_{h=1}^H N^2_h\\frac{\\hat{p_h}(1- \\hat{p_h})}{n_h - 1}(1 - \\frac{n_h}{N_h})}$$\n\n## Clustered sampling\n\nApplies if a population can be divided into mutually exclusive subgroups (clusters \nor primary sampling units (PSU)).A random selection of PSUs is sampled followed \nby another level of sampling within the chosen clusters. Suppose $a$ clusters \nare sampled from a population of A clusters via SRS. Within each sampled cluster\n$i$ there are $B_i$ units in the population of which $b_i$ units are sampled using\nSRS. if $\\hat{y}_i$ is the $i$th cluster mean, then the population mean is \nestimated by\n\n$$\\hat{y} = \\frac{\\sum_{i=1}^aB_i\\hat{y_i}}{\\sum_{i=1}^a B_i}$$\n\n$$se(\\hat{y}) = \\frac{1}{\\hat{N}}\\sqrt{(1 - \\frac{a}{A})\\frac{s^2_a}{a} + \\frac{A}{a}\\sum_{i=1}^a(1 - \\frac{b_i}{B_i}) \\frac{s_i^2}{b_i}}$$\nwhere $\\hat{N}$ is the estimated population size, $s^2_a$ is the between-cluster\nvariance, and $s^2_i$ is the within-cluster variance.\n\nBetween-cluster variance $s^2_a$ is:\n\n$$s_a^2 = \\frac{1}{a - 1} \\sum_{i = 1}^a (\\hat{y_i} - \\frac{\\sum_{i=1}^a \\hat{y_i}}{a})^2$$\nwhere $\\frac{\\sum_{i=1}^a \\hat{y_i}}{a} = \\bar{y}$ is the grand mean.\n\nThe within-cluster variance ($s^2_i$) is estimated through\n\n$$s^2_i = \\frac{1}{a(b_i - 1)} \\sum_{j = 1}^{b_i}(y_{ij} - \\hat{y_i})$$\nwhere $y_{ij}$ is the outcome for sampled unit $j$ from cluster $i$\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}